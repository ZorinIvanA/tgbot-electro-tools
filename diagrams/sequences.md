# Диаграмы последовательности
## Без ИИ (машина состояний)
```mermaid
sequenceDiagram
    title Сценарий 1: Без ИИ
    participant Пользователь
    participant Бот
    participant База данных

    Пользователь->>Бот: Болгарка не включается!
    Бот->>База данных: Ищу по ключевым словам<br>("не включается", "молчит"…)
    База данных-->>Бот: Найден сценарий:<br>«УШМ не запускается»
    Бот->>Пользователь: Что значит «не включается»?<br>Опишите проблему.
    Пользователь->>Бот: Она не жужжит, просто молчит!
    Бот->>База данных: Получить следующий шаг сценария
    База данных-->>Бот: Спросить про рычажок предохранителя
    Бот->>Пользователь: Нажимаете ли вы рычажок<br>предохранителя при включении?
```

## С ИИ для распознавания запроса пользователя
```mermaid
sequenceDiagram
    title Сценарий 2: С ИИ (Bothub.ru)
    participant Пользователь
    participant Бот
    participant Bothub.ru
    participant База данных

    Пользователь->>Бот: Она просто молчит!
    Бот->>Bothub.ru: Понять смысл сообщения
    Bothub.ru-->>Бот: Намерение: «ушм_не_включается»<br>Уверенность: 92%
    Бот->>База данных: Найти сценарий «ушм_не_включается»
    База данных-->>Бот: Найден сценарий
    Бот->>Пользователь: Давайте проверим:<br>включена ли болгарка в сеть?
    Пользователь->>Бот: Да, но она не реагирует.
    Бот->>База данных: Получить следующий шаг
    База данных-->>Бот: Спросить про предохранитель
    Бот->>Пользователь: Попробуйте нажать<br>рычажок предохранителя!
```

## Предложение ссылки на сайт
```mermaid
sequenceDiagram
    title Сценарий: Предложение ссылки (ответ «Да»)
    participant Пользователь
    participant Бот
    participant База данных

    Пользователь->>Бот: Как заменить диск на болгарке?
    Бот->>База данных: Найти ответ по ключевым словам
    База данных-->>Бот: Ответ: «Отключите УШМ от сети...»
    Бот->>Пользователь: Отключите УШМ от сети, нажмите фиксатор вала...
    Бот->>База данных: Увеличить счётчик (1/3)

    Пользователь->>Бот: А если диск заклинило?
    Бот->>База данных: Найти ответ по сценарию "заклинивание"
    База данных-->>Бот: Ответ: «Не пытайтесь силой...»
    Бот->>Пользователь: Не пытайтесь вынуть диск силой — это опасно...
    Бот->>База данных: Увеличить счётчик (2/3)

    Пользователь->>Бот: Как снять защитный кожух?
    Бот->>База данных: Найти инструкцию по кожуху
    База данных-->>Бот: Ответ: «Отвинтите два винта...»
    Бот->>Пользователь: Отвинтите два винта сбоку корпуса...
    Бот->>База данных: Увеличить счётчик (3/3) → порог достигнут

    Бот->>Пользователь: Хотите прочитать более подробную информацию<br>на нашем сайте?
    Пользователь->>Бот: Да

    Бот->>База данных: Получить ссылку на сайт
    База данных-->>Бот: https://shop.example.com
    Бот->>Пользователь: Вот ссылка: https://shop.example.com
```