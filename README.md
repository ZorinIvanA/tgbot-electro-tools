# Telegram Bot for Electro Tools Support

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

Telegram-–±–æ—Ç –¥–ª—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —ç–ª–µ–∫—Ç—Ä–æ–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ (–£–®–ú, –¥—Ä–µ–ª–∏ –∏ —Ç.–¥.). –ë–æ—Ç —Ä–∞–∑–º–µ—â–∞–µ—Ç—Å—è –ø–æ QR-–∫–æ–¥—É –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–µ —Ç–æ–≤–∞—Ä–∞ –≤ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–µ –∏ –ø–æ–º–æ–≥–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–µ–∏—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç–∏. –ü–æ—Å–ª–µ –∑–∞–¥–∞–Ω–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –±–æ—Ç –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ —Å–∞–π—Ç –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π.

**‚ö†Ô∏è –í–∞–∂–Ω–æ:** –ë–æ—Ç —Å—Ç—Ä–æ–≥–æ —Å–æ–±–ª—é–¥–∞–µ—Ç –ø—Ä–∞–≤–∏–ª–∞ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–∞ - –Ω–∏–∫–∞–∫–∏—Ö –ø—Ä—è–º—ã—Ö —Ä–µ–∫–ª–∞–º–Ω—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤, –∞–∫—Ü–∏–π –∏–ª–∏ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è —Ü–µ–Ω –¥—Ä—É–≥–∏—Ö —Ç–æ–≤–∞—Ä–æ–≤/–±—Ä–µ–Ω–¥–æ–≤.

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
.
‚îú‚îÄ‚îÄ cmd/bot/           # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ internal/
‚îÇ   ‚îú‚îÄ‚îÄ bot/           # –õ–æ–≥–∏–∫–∞ Telegram –±–æ—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ fsm/           # –ö–æ–Ω–µ—á–Ω—ã–π –∞–≤—Ç–æ–º–∞—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–π –¥–∏–∞–ª–æ–≥–∞
‚îÇ   ‚îú‚îÄ‚îÄ storage/       # –†–∞–±–æ—Ç–∞ —Å PostgreSQL
‚îÇ   ‚îú‚îÄ‚îÄ metrics/       # –°–±–æ—Ä –º–µ—Ç—Ä–∏–∫ –≤ —Ñ–æ—Ä–º–∞—Ç–µ Prometheus
‚îÇ   ‚îî‚îÄ‚îÄ api/           # HTTP API –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è
‚îú‚îÄ‚îÄ migrations/        # SQL-–º–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ Dockerfile         # –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è
‚îî‚îÄ‚îÄ azure-pipelines.yml # CI/CD –¥–ª—è Azure DevOps
```

## üöÄ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

### Telegram-–≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ
- **`/start`** - –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
- **–°—á—ë—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏–π** - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ —Å—Å—ã–ª–∫–∏** - –ø–æ—Å–ª–µ N —Å–æ–æ–±—â–µ–Ω–∏–π –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ —Å–∞–π—Ç
- **–î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–π —Å—Ü–µ–Ω–∞—Ä–∏–π –£–®–ú** - –ø–æ—à–∞–≥–æ–≤–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º —Å –∑–∞–ø—É—Å–∫–æ–º

### –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –£–®–ú (–£–≥–ª–æ—à–ª–∏—Ñ–æ–≤–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã)
–¢—Ä–∏–≥–≥–µ—Ä—ã –∞–∫—Ç–∏–≤–∞—Ü–∏–∏: `"–Ω–µ –≤–∫–ª—é—á–∞–µ—Ç—Å—è"`, `"–Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è"`, `"–º–æ–ª—á–∏—Ç"`, `"–Ω–µ –∂—É–∂–∂–∏—Ç"`, `"–Ω–µ –∫—Ä—É—Ç–∏—Ç"`

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–æ—Ü–µ—Å—Å:**
1. **–®–∞–≥ 1**: –†–∞—Å—Å–ø—Ä–æ—Å–∏—Ç—å –æ —Å–∏–º–ø—Ç–æ–º–∞—Ö
2. **–®–∞–≥ 2**: –ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å –±–∞–∑–æ–≤—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ (—Ä–æ–∑–µ—Ç–∫–∞, –ø—Ä–µ–¥–æ—Ö—Ä–∞–Ω–∏—Ç–µ–ª—å, –∫–∞–±–µ–ª—å, —à–ø–∏–Ω–¥–µ–ª—å)
3. **–®–∞–≥ 3**: –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞—Ç—å —Å–µ—Ä–≤–∏—Å–Ω—ã–π —Ü–µ–Ω—Ç—Ä –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

### –°–±–æ—Ä email
- –ó–∞–ø—Ä–æ—Å email –ø–æ—Å–ª–µ —Å–æ–≥–ª–∞—Å–∏—è –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ —Å–∞–π—Ç
- –í–∞–ª–∏–¥–∞—Ü–∏—è email —Ñ–æ—Ä–º–∞—Ç–∞
- –ó–∞–ø—Ä–æ—Å —è–≤–Ω–æ–≥–æ —Å–æ–≥–ª–∞—Å–∏—è –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î —Å —Ñ–ª–∞–≥–æ–º —Å–æ–≥–ª–∞—Å–∏—è

### HTTP API (–¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è)

| –ú–µ—Ç–æ–¥ | –ü—É—Ç—å | –û–ø–∏—Å–∞–Ω–∏–µ | –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è |
|-------|------|----------|----------------|
| GET | `/api/v1/metrics` | –≠–∫—Å–ø–æ—Ä—Ç –º–µ—Ç—Ä–∏–∫ Prometheus | –ù–µ—Ç |
| GET | `/api/v1/settings` | –ü–æ–ª—É—á–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ | Bearer token |
| PUT | `/api/v1/settings` | –û–±–Ω–æ–≤–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ | Bearer token |

### –ú–µ—Ç—Ä–∏–∫–∏ (Prometheus)
- `telegram_bot_active_users_total{period="24h"}` - —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∑–∞ 24 —á–∞—Å–∞
- `telegram_bot_messages_total` - –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π
- `telegram_bot_fsm_state{state="idle"}` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è–º FSM

## üîß –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Go 1.25** - –æ—Å–Ω–æ–≤–Ω–æ–π —è–∑—ã–∫
- **PostgreSQL 15+** - –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **Telegram Bot API v5** - –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å Telegram
- **Docker** - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è
- **Azure DevOps** - CI/CD

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Go 1.25+
- PostgreSQL 15+
- Docker (–¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)

### –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫

1. **–ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π**
   ```bash
   git clone https://github.com/ZorinIvanA/tgbot-electro-tools.git
   cd tgbot-electro-tools
   ```

2. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö**
   ```bash
   createdb electro_tools_bot
   psql -d electro_tools_bot -f migrations/001_create_initial_schema.sql
   ```

3. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**
   ```bash
   cp .env.example .env
   # –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å .env —Ñ–∞–π–ª
   ```

4. **–ó–∞–ø—É—Å—Ç–∏—Ç—å**
   ```bash
   go run cmd/bot/main.go
   ```

### Docker –∑–∞–ø—É—Å–∫

```bash
# –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞
docker build -t telegram-electro-tools-bot .

# –ó–∞–ø—É—Å–∫ —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è
docker run -p 8080:8080 --env-file .env telegram-electro-tools-bot

# –¢–æ —á—Ç–æ –∑–∞–ø—É—Å—Ç–∏–ª–æ—Å—å
sudo docker run --rm --network host   -e TELEGRAM_BOT_TOKEN='321'   -e ADMIN_API_TOKEN='123'   -e DB_HOST='127.0.0.1'   -e DB_PORT='5433'   -e DB_USER='user'   -e DB_PASSWORD='password'   -e DB_NAME='electro-tools'   -e DB_SSLMODE='disable'   e-tools
```

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env)

```env
# Telegram Bot
TELEGRAM_BOT_TOKEN=your_bot_token_here

# Database
DB_HOST=localhost
DB_PORT=5432
DB_USER=postgres
DB_PASSWORD=postgres
DB_NAME=electro_tools_bot
DB_SSLMODE=disable

# HTTP API
HTTP_PORT=8080
ADMIN_API_TOKEN=your_secret_admin_token_here

# Settings
DEFAULT_SITE_URL=https://example.com
RATE_LIMIT_PER_MINUTE=10
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
```bash
go test ./... -v -cover
```

### –ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞
–¶–µ–ª—å: ‚â•70% –¥–ª—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ FSM –ø–µ—Ä–µ—Ö–æ–¥–æ–≤
- –í–∞–ª–∏–¥–∞—Ü–∏—è email
- –õ–æ–≥–∏–∫–∞ —Ç—Ä–∏–≥–≥–µ—Ä–∞ —Å—Å—ã–ª–∫–∏
- Rate limiting

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ú–µ—Ç—Ä–∏–∫–∏ Prometheus
```bash
curl http://localhost:8080/api/v1/metrics
```

### Health check
```bash
curl http://localhost:8080/health
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- **Rate limiting** - –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –º–∏–Ω—É—Ç—É
- **Input validation** - –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **SQL injection protection** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ prepared statements
- **Bearer token authentication** - –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ API

## üöÄ –î–µ–ø–ª–æ–π

### Azure DevOps Pipeline
1. **Validate** - go fmt, go vet, go mod tidy
2. **Test** - –∑–∞–ø—É—Å–∫ unit-—Ç–µ—Å—Ç–æ–≤ —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º
3. **Build** - —Å–±–æ—Ä–∫–∞ Docker-–æ–±—Ä–∞–∑–∞
4. **Deploy** - —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤ Kubernetes

### Production requirements
- Kubernetes –∫–ª–∞—Å—Ç–µ—Ä
- PostgreSQL –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- Azure Container Registry
- Azure DevOps pipeline

## üìù API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –ü–æ–ª—É—á–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
```bash
GET /api/v1/settings
Authorization: Bearer <ADMIN_API_TOKEN>
```

### –û–±–Ω–æ–≤–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
```bash
PUT /api/v1/settings
Authorization: Bearer <ADMIN_API_TOKEN>
Content-Type: application/json

{
  "trigger_message_count": 5,
  "site_url": "https://new-example.com"
}
```

## ü§ù Contributing

1. Fork –ø—Ä–æ–µ–∫—Ç
2. –°–æ–∑–¥–∞—Ç—å feature branch (`git checkout -b feature/AmazingFeature`)
3. –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è (`git commit -m 'Add some AmazingFeature'`)
4. Push –≤ branch (`git push origin feature/AmazingFeature`)
5. –°–æ–∑–¥–∞—Ç—å Pull Request

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ª–∏—Ü–µ–Ω–∑–∏—Ä–æ–≤–∞–Ω –ø–æ–¥ MIT License - —Å–º. —Ñ–∞–π–ª [LICENSE](LICENSE) –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã

- **–ê–≤—Ç–æ—Ä**: Ivan Zorin
- **Email**: ivan.zorin@example.com
- **GitHub**: [@ZorinIvanA](https://github.com/ZorinIvanA)

---

## üéØ MVP Scope

‚úÖ Telegram –±–æ—Ç —Å –±–∞–∑–æ–≤—ã–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–æ–º  
‚úÖ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –£–®–ú  
‚úÖ –°–±–æ—Ä email —Å —Å–æ–≥–ª–∞—Å–∏–µ–º  
‚úÖ HTTP API –¥–ª—è –º–µ—Ç—Ä–∏–∫ –∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫  
‚úÖ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è  
‚úÖ Unit-—Ç–µ—Å—Ç—ã  
‚úÖ CI/CD pipeline  
‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è  

**–°–ª–µ–¥—É—é—â–∏–µ –≤–µ—Ä—Å–∏–∏:**
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –¥—Ä—É–≥–∏—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ (–¥—Ä–µ–ª–∏, –ø–µ—Ä—Ñ–æ—Ä–∞—Ç–æ—Ä—ã)
- –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏
- –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
- –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è